\newpage


\section{Локальные модели в задачах кластеризации временных рядов}
Анализ физической активности человека производится при помощи мобильных телефонов, разумных часов \cite{kwapisz2010, wang2014}. 
Эти устройства используют акселерометр, гироскоп и магнитометр. 
Цель данной работы заключается в  разметке и распознавании человеческой активности \cite{Ignatov2015, Olivares2012, cinar2018}, а также поиска начала каждого действия \cite{motrenko2015}. 
Примерами одного сегмента действия служит шаг, шаг бега, приседание, прыжок и др. 
Исследуются последовательности, которые состоят не менее чем из двух подряд идущих сегментов, которые соответствуют одному и тому жу типу человеческой активности.

\begin{figure}[h!t]\center
\subfloat[]
{\includegraphics[width=0.5\textwidth]{results/series/example}\label{example:1}}
\subfloat[]
{\includegraphics[width=0.5\textwidth]{results/series/example_phase}\label{example:2}}\\
\caption{Временной ряд, с разметкой на кластеры: a) временной ряд с ассесорской разметкой на кластеры и выделением начала квазипериодического сегмента; b) проекция фазовых траекторий на первые две главные компоненты }
\end{figure}

Временные ряды --- это объекты сложной структуры. 
При их классификации значимую роль играет модель построения признакового пространства.
В данной работе объектом анализа и кластеризации является точка на оси времени. 
Решается задача кластеризации точек временного ряда. 
При \textit{кластеризации} каждой точке временного ряда ставится в соответствие метка из конечного множества меток. 
Каждая метка соответствует одному характерному физическому действию. \textit{Сегмент} это часть временного ряда, которая соответствует одному характерному физическому действию, например: шаг двумя ногами при ходьбе, или шаг двумя ногами при беге.
Последовательность сегментов, которые соответствуют одному физическому действия образуют \textit{цепочку} действий. 
Предполагается, что цепочка действий образует квазипериодическую последовательность значений временного ряда.
Последовательность точек $\{b_t\}_{t=1}^{N}$ назовем \textit{квазипериодической} с периодом $T$, если для всех $t$ найдется $\Delta$, такое что:
\[
\label{eq:int:1}
\begin{aligned}
b_t \approx b_{t+T+\Delta}, \quad \left|\Delta\right| \ll T.
\end{aligned}
\]
Пример кластеризации и разбиения ряда на сегменты показан на рис. \ref{example:1}. Данный ряд разбит на два характерных физических действия, которые обозначаются Type 1 и Type 2. Также данный ряд содержит в себе две квазипериодические цепочки действий.

Решение задачи кластеризации состоит из двух этапов. 
Во-первых, для получения признакового описания временного ряда предлагается алгоритм локальной аппроксимации временного ряда при помощи метода главных компонент \cite{Shiglavsi1997}. 
Под \textit{локальной} аппроксимацией временного ряда подразумевается, что для признакового описания его точки используется не весь ряд, а только некоторая окрестность данной точки. 
В качестве признакового описания точки временного ряда рассматриваются две главные компоненты \textit{сегмента фазовой траектории} в окрестности данной точки.
На рис. \ref{example:2} показаны две первые главные компоненты \textit{фазовых траекторий}, а также проекция фазовых траекторий на эти компоненты.
Они соответствуют разным физическим действиям, которые обозначаются Type 1 и Type 2, внутри одного временного ряда.
Как видно плоскости, которые порождены данными главными компонентами не совпадают. 
Это говорит о том, что наблюдаются различные действия. 
Во-вторых, вводится функция расстояния в построенном пространстве признакового описания. 
Данная функция является расстояниям между двумя базисами некоторых подпространств внутри всего фазового пространства временного ряда.
На рис. \ref{example:2} данная функция является некоторым расстояниям между двумя плоскостями.
Получив расстояния между точками временного ряда, выполним кластеризацию данных точек.
Задача сегментации внутри каждого кластера решается при помощи метода, который рассмотрен в \cite{motrenko2015}.

Для решения задачи кластеризации точек временного ряда вводятся предположения. 
Предполагается, что периоды различных сегментов различаются незначительно, причем известны минимальный и максимальный периоды сегмента и число различных сегментов внутри временного ряда. 
Также предполагается, что тип активности во времени не меняется часто, а также что фазовые траектории разных сегментов являются различными. 

Проверка и анализ метода кластеризации проводится на синтетической и реальной выборках. 
Синтетическая выборка построенная при помощи суммы нескольких первых членов ряда Фурье со случайными коэффициентами. 
Эксперимент по сегментации временного ряда проводился на простых синусоидальных сигналах с произвольной амплитудой и частотой. 
Реальные данные получены при помощи мобильного акселерометра, который снимал показания во время некоторой физической активности человека. 

В \cite{kwapisz2010} рассматриавется метод построения признакового описания на основе экспертно заданых порождающих функций.
В \cite{lukashin2003} рассматривается метод построения признаков на основе гипотезы порождения данных. 
В \cite{Ivkin2015} рассматривается комбинированное признаковое описание на основе данных методов. 
В \cite{Katrutsa2015} рассматривается проблема построение признакового пространства и предлагается критерий избыточности выбранных признаков.

Работа \cite{motrenko2015} является ближайшей работой по данной теме. Она заключается в поиске начала сегмента внутри квазипериодического сигнала, который состоит, только из одной цепочки действий. Этот метод основан на исследовании фазового пространства, а именно поиска устойчивой гиперплоскости, которая делит фазовое пространство на две равные части. В качестве начала сегмента выбираются точки, которые находятся близко к данной гиперплоскости. В \cite{motrenko2015} предлагается выполнить проекцию фазового пространства на первые две главное компоненты, после чего провести устойчивую прямую, выделив начала каждого сегмента. 
Данный метод имеет недостаток в том, что позволяет находить начало только для временного ряда, который состоит из квазипериодического сигнала единственного типа.


Также близкой является работа \cite{cinar2018}.  Данная работа заключается в поиске периодической структуры внутри ряда при помощи модели LSTM с модифицированным механизмом Attention. Предполагается, что механизм Attention будет давать максимальное значение score в точках, которые удаленны от данной на целое количество периодов.

\subsection{Постановка задачи кластеризации точек временного ряда}

Задан временной ряд
\[
\label{eq:st:1}
\begin{aligned}
\textbf{x} \in \mathbb{R}^{N},
\end{aligned}
\]
где $N$ число точек временного ряда. Он состоит из последовательности сегментов:
\[
\label{eq:st:2}
\begin{aligned}
\textbf{x} = [\textbf{v}_1, \textbf{v}_2, \cdots, \textbf{v}_M],
\end{aligned}
\]
где $\textbf{v}_i$ некоторый сегмент из множества сегментов $\mathbf{V}$, которые встречаются в данном ряде. 
Причем для всех $i$ либо $[\textbf{v}_{i-1},\textbf{v}_{i}]$ либо $[\textbf{v}_{i},\textbf{v}_{i+1}]$  является цепочкой действий. Пусть множество $\mathbf{V}$ удовлетворяет следующим свойствам:

\[
\label{eq:st:3}
\begin{aligned}
\left|\mathbf{V}\right| = K, \quad \textbf{v} \in \mathbf{V} \left|\textbf{v}\right| \leq T,
\end{aligned}
\]
где $\left|\mathbf{V}\right|$ число различных действий в множестве сегментов $\mathbf{V},$ $\left|\textbf{v}\right|$ длина сегмента, а $K$ и $T$ это число различных действий во временном ряде и длина максимального сегмента соответсвенно.

Рассматривается отображение
\[
\label{eq:st:4}
\begin{aligned}
a : t \to \mathbb{Y} = \{1,\cdots, K\}, 
\end{aligned}
\]
где $t \in \{1,\cdots, N\}$ некоторый момент времени, на котором задан временной ряд.
Требуется, чтобы отображение $a$ удовлетворяло следующим свойствам:

\[
\label{eq:st:5}
\begin{aligned}
\begin{cases}
    a\left(t_1\right) = a\left(t_2\right), &  \text{если в моменты } t_1, t_2 \text{ совершается один тип действий}\\
    a\left(t_1\right) \not= a\left(t_2\right), &  \text{если в моменты } t_1, t_2 \text{ совершаются разные типы действий }
\end{cases}
\end{aligned}
\]

Пусть задана некоторая асессорская разметка временного ряда:
\[
\label{eq:st:6}
\begin{aligned}
\textbf{y} \in \{1,\cdots,K\}^{N}.
\end{aligned}
\]
Тогда ошибка алгоритма $a$ на временном ряде $\textbf{x}$ представляется в следующем виде:
\[
\label{eq:st:7}
\begin{aligned}
S = \frac{1}{N}\sum_{t=1}^{N}[y_t = a\left(t\right)],
\end{aligned}
\]
где $t$ --- момент времени, $y_t$ асессорская разметка $t$-го момента времени для заданого временного ряда.


\subsection{Кластеризация точек в фазовом пространстве}
Рассмотрим фазовую траекторию временного ряда $\textbf{x}$:
\[
\label{eq:cl:1}
\begin{aligned}
\mathbf{H} = \{\textbf{h}_t| \textbf{h}_t = [x_{t-T}, x_{t-T+1}, \cdots, x_{t}], T\leq t\leq N\},
\end{aligned}
\]
где $\textbf{h}_t$ --- точка фазовой траектории.

Информация об длине максимального сегмента $T$ внутри временного ряда позволяет разбить фазовую траекторию на сегменты из $2T$ векторов:
\[
\label{eq:cl:2}
\begin{aligned}
\mathbf{S} = \{\textbf{s}_t| \textbf{s}_t = [\textbf{h}_{t-T}, \textbf{h}_{t-T+1}, \cdots, \textbf{h}_{t+T-1}], T\leq t\leq N-T\},
\end{aligned}
\]
где $\textbf{s}_t$ --- это сегмент фазовой траектории. Данные сегменты имеют всю локальную информацию об временном ряде, так как содержит всю информацию на периоде до момента времени $t$ и информацию о периоде после момента времени $t$.

В качестве признакового описания точки временного ряда $t$ рассматриваются главные компоненты $\textbf{W}_t$ для $T\text{-мерных}$ сегментов $\textbf{s}_t$. Сегмент $\textbf{s}_t$ проекцируется на подпространство размерности два при помощи метода главных  компонент $\textbf{z}_t = \textbf{W}_t\textbf{s}_t$. Получаем:

%Каждое $T\text{-мерное}$ подпространство $\textbf{s}_t$ проектируется на подпространство значительно меньшей размерности при помощи метода главных  компонент $\textbf{z}_t = \textbf{W}_t\textbf{s}_t$. Получим представление базисных векторов $\textbf{W}_t$, а также собственные числа, которые соответствуют данным базисным векторам каждого подпространства $\textbf{s}_t$ в $T\text{-мерном}$ пространстве:
\[
\label{eq:cl:3}
\begin{aligned}
\mathbf{W} = \{\textbf{W}_t| \textbf{W}_t = [\lambda^1_t\textbf{w}^1_t, \lambda^2_t\textbf{w}^2_t]\}, \quad \bm{\Lambda} = \{\bm{\lambda}_t| \bm{\lambda}_t=[\lambda^1_t, \lambda^2_t]\},
\end{aligned}
\]
где $[\textbf{w}^1_t, \textbf{w}^2_t]$ и $[\lambda^1_t, \lambda^2_t]$ это базисные векторы и соответствующие им собственные для сегмента фазовой траектории $\textbf{s}_t$.

Для кластеризации точек временного ряда рассмотрим функцию расстояния между элементами $\mathbf{W}_{t_1},\mathbf{W}_{t_2}$:
\[
\label{eq:cl:4}
\begin{aligned}
\rho\left(\textbf{W}_1, \textbf{W}_2\right) = \max\left(\max_{\textbf{e}_2 \in \textbf{W}_2} d_{1}\left(\textbf{e}_2\right), \max_{\textbf{e}_1 \in \textbf{W}_1} d_{2}\left(\textbf{e}_1\right)\right),
\end{aligned}
\]
где  $\textbf{e}_i$ это базисный вектор пространства $\textbf{W}_i,$ а $d_i\left(\textbf{e}\right)$ является расстоянием от вектора $\textbf{e}$ до пространства $\textbf{W}_i$.

\begin{comment}
\begin{theorem}
Пусть задано множество подпространств $\mathbb{W}$ пространства $\mathbb{R}^{n}$. Каждое подпространство которого задается базисом $\mathbf{W}_i\in \mathbf{W}$, тогда функция расстояния $\rho\left(\textbf{W}_1, \textbf{W}_2\right)$ является метрикой заданой на множестве базисов $\mathbf{W}$:
\[
\begin{aligned}
\rho\left(\textbf{W}_1, \textbf{W}_2\right) = \max\left(\max_{\textbf{e}_2 \in \textbf{W}_2} d_{1}\left(\textbf{e}_2\right), \max_{\textbf{e}_1 \in \textbf{W}_1} d_{2}\left(\textbf{e}_1\right)\right),
\end{aligned}
\]
где $\textbf{e}_i$ это базисный вектор из $\textbf{W}_i$, a $d_i\left(\textbf{e}\right)$ является расстоянием от вектора $\textbf{e}$ до пространства заданого базисом $\textbf{W}_i$.
\end{theorem}

В силу теоремы \ref{th:1} функция расстояния (\ref{eq:cl:4}) является метрикой, доказательство данной теоремы представлено в приложении \ref{ProofTheorem1}. 
\end{comment}

В случае, когда все подпространства $\textbf{W}_t$ имеют размерность два, расстояние $\rho\left(\textbf{W}_1, \textbf{W}_2\right)$ имеет следующую интерпретацию:

\[
\label{eq:cl:5}
\begin{aligned}
\rho\left(\textbf{W}_1, \textbf{W}_2\right) = \max_{\{\textbf{a},\textbf{b},\textbf{c}\} \subset \textbf{W}_1\cup \textbf{W}_2 } V\left(\textbf{a},\textbf{b},\textbf{c}\right), 
\end{aligned}
\]
где $\textbf{W}_1\cup\textbf{W}_2$ это объединение базисных векторов первого и второго пространства, $V\left(\textbf{a},\textbf{b},\textbf{c}\right)$ --- объем параллелепипеда построенного на векторах $\textbf{a}, \textbf{b}, \textbf{c}$, которые являются столбцами матрицы $\textbf{W}_1\cup\textbf{W}_2$.


Рассмотрим расстояние между собственными числами:
\[
\label{eq:cl:6}
\begin{aligned}
\rho\left(\bm{\lambda}_1, \bm{\lambda}_2\right) = \sqrt[]{\left(\bm{\lambda}_1 - \bm{\lambda}_2\right)^{\mathsf{T}}\left(\bm{\lambda}_1 - \bm{\lambda}_2\right)}.
\end{aligned}
\]
%Функция расстояния $\rho\left(\bm{\lambda}_1, \bm{\lambda}_2\right)$ является метрикой в пространстве $\mathbb{R}^2$.
%Матрица попарных расстояний между базисными векторами $\textbf{M}_{\text{c}}$ и матрица попарных расстояний между собственными значениями $\textbf{M}_{\text{l}}$ для временного ряда $\textbf{x}$:
%\[
%\label{eq:cl:8}
%\begin{aligned}
%\textbf{M}_{\text{c}} = [0, 1]^{N\times N}, \quad \textbf{M}_{\text{l}} = [0, 1]^{N\times N}.
%\end{aligned}
%\]
Используя выражения (\ref{eq:cl:5}-\ref{eq:cl:6}) введем расстояние между двумя точками $t_1, t_2$ временного ряда, а также рассмотрим матрицу попарных расстояний $\textbf{M}$ между точками данного ряда:
\[
\label{eq:cl:9}
\begin{aligned}
\rho\left(t_1, t_2\right) = \rho\left(\textbf{W}_1, \textbf{W}_2\right) + \rho\left(\bm{\lambda}_1, \bm{\lambda}_2\right), \quad \textbf{M} =  \mathbb{R}^{N\times N},
\end{aligned}
\]
где % $\rho\left(t_1, t_2\right)$ является метрикой, так как является суммой двух метрик,
матрица $\textbf{M}$ является матрицей попарных расстояний между всеми парами точек $t$ временного ряда $\textbf{x}$.
Используя матрицу попарных расстояний $\textbf{M}$ выполним кластеризацию моментов времени $t$ временного ряда \eqref{eq:st:4}:

%\[
%\label{eq:cl:10}
%\begin{aligned}
%a : t \to \{1,\cdots, K\}, 
%\end{aligned}
%\]
%где $t$ некоторый момент времени временного ряда $\textbf{x}$.

\subsection{Анализ фазовых траекторий в задаче кластеризации точек временного ряда}
Для анализа свойств предложенного алгоритма кластериизации был проведен вычислительный эксперимент в котором кластеризация точек временного ряда проводилась используя матрицы попарных расстояний $(\ref{eq:cl:9})$.

В качестве данных использовались две выборки временных рядов, которые описаны в таблице \ref{table_1}. 
Выборка Physical Motion это реальные временные ряды полученные при помощи мобильного акселерометра. 
Синтетические временные ряды были построены при помощи нескольких первых слагаемых ряда Фурье со случайными коэффициентами из стандартного нормального распределения. 
Генерация данных состояла из двух этапов. 
На первом этапе генерировались короткие сегменты $\textbf{v}$ для построения множества $\mathbf{V}$. 
Вторым этапом генерации выборки $\textbf{x}$ является следующим случайным процессом:
\[
\label{eq:exp:1}
\begin{aligned}
\textbf{x} = [\textbf{v}_{1}, \textbf{v}_{2}, \cdots, \textbf{v}_{M}] + \bm{\varepsilon}, \quad \begin{cases}
    \textbf{v}_{1} \sim \mathcal{U}\left(\mathbf{V}\right),\\
    \textbf{v}_{i} = \textbf{v}_{i - 1}, & \text{с вероятностью} \frac{3}{4}\\
    \textbf{v}_{i} \sim \mathcal{U}\left(\mathbf{V}\right), & \text{с вероятностью} \frac{1}{4}
\end{cases},
\end{aligned}
\]
где $\mathcal{U}\left(\mathbf{V}\right)$ --- равномерное распределение на объектах из $\mathbf{V},$ а $\bm{\varepsilon}$ является шумом из нормального распределения.

\begin{table}[h!t]
\begin{center}
\caption{Описание временных рядов в эксперименте кластеризации точек временного ряда}
\label{table_1}
\begin{tabular}{|c|c|c|c|}
\hline
	Ряд, $\textbf{x}$ &Длина ряда, $N$& Число сегментов, $K$&Длина сегмента, $T$\\
	\hline
	\multicolumn{1}{|l|}{Physical Motion 1}
	& 900& 2& 40\\
	\hline
	\multicolumn{1}{|l|}{Physical Motion 2}
	& 900& 2& 40\\
	\hline
	\multicolumn{1}{|l|}{Synthetic 1}
	& 2000& 2& 20\\
	\hline
	\multicolumn{1}{|l|}{Synthetic 2}
	& 2000& 3& 20\\
\hline

\end{tabular}
\end{center}
\end{table}

\begin{figure}[h!t]\center
\subfloat[]
{\includegraphics[width=0.5\textwidth]{results/series/2_patern_2_series}\label{fig_synthetic_series_2}}
\subfloat[]
{\includegraphics[width=0.5\textwidth]{results/series/3_patern_2_series}\label{fig_synthetic_series_3}}\\
\caption{Пример синтетически построенных временных рядов: a) для временного ряда Synthetic 1; b) для временного ряда Synthetic 2}
\label{fig_synthetic_series}
\end{figure}

\begin{figure}[h!t]\center
\subfloat[]
{\includegraphics[width=0.5\textwidth]{results/series/2_patern_2_full}}
\subfloat[]
{\includegraphics[width=0.5\textwidth]{results/series/3_patern_2_full}}\\
\caption{Матрица попарных расстояний $\textbf{M}$ между точками временного ряда: a) для временного ряда Synthetic 1; b) для временного ряда Synthetic 2}
\label{fig_synthetic_distance}
\end{figure}

\begin{figure}[h!t]\center
\subfloat[]
{\includegraphics[width=0.5\textwidth]{results/series/2_patern_2_2D_vector}}
\subfloat[]
{\includegraphics[width=0.5\textwidth]{results/series/3_patern_2_2D_vector}}\\
\caption{Проекция точек временного ряда на плоскость при помощи матрицы попарных расстояний $\textbf{M}$: a) для временного ряда Synthetic 1; b) для временного ряда Synthetic 2}
\label{fig_synthetic_2D}
\end{figure}

\begin{figure}[h!t]\center
\subfloat[]
{\includegraphics[width=0.5\textwidth]{results/series/2_patern_2_claster_vector}}
\subfloat[]
{\includegraphics[width=0.5\textwidth]{results/series/3_patern_2_claster_vector}}\\
\caption{Кластеризация точек временного ряда: a) для временного ряда Synthetic 1; b) для временного ряда Synthetic 2}
\label{fig_synthetic_claster}
\end{figure}


\paragraph{Синтетические данные.}


На рис. \ref{fig_synthetic_series} приведен пример синтетических временных рядов. 
На рис. \ref{fig_synthetic_series_2} показан пример ряда в котором число различных сегментов $K = 2$, а длина каждого сегмента $T = 20$. 
На рис. \ref{fig_synthetic_series_3} показан пример ряда в котором число различных сегментов $K = 3$, а длина каждого сегмента $T = 20$. 

Рис. \ref{fig_synthetic_distance} иллюстрирует матрицы попарных расстояний $\textbf{M}$ между всеми парами точек $t$ временного ряда, которые построены при помощи (\ref{eq:cl:9}). 
Используя матрицу попарных расстояний и метод Multidimensional Scaling \cite{Borg2005} визуализируем точки временного ряда на плоскости. 
На рис. \ref{fig_synthetic_2D} показана визуализация точек на плоскости и выполнена их кластеризация при помощи метода иерархической кластеризации. 
Иллюстрация кластеров точек временного ряда продемонстрирована на рис. \ref{fig_synthetic_claster}.

\begin{figure}[h!t]\center
\subfloat[]
{\includegraphics[width=0.5\textwidth]{results/series/real_1_series}}
\subfloat[]
{\includegraphics[width=0.5\textwidth]{results/series/real_2_series}}\\
\caption{Пример синтетически построенных временных рядов: a) для временного ряда Physical Motion 1; b) для временного ряда Physical Motion 2}
\label{fig_real_series}
\end{figure}

\begin{figure}[h!t]\center
\subfloat[]
{\includegraphics[width=0.5\textwidth]{results/series/real_1_full}}
\subfloat[]
{\includegraphics[width=0.5\textwidth]{results/series/real_2_full}}\\
\caption{Матрица попарных расстояний $\textbf{M}$ между точками временного ряда: a) для временного ряда Physical Motion 1; b) для временного ряда Physical Motion 2}
\label{fig_real_distance}
\end{figure}

\begin{figure}[h!t]\center
\subfloat[]
{\includegraphics[width=0.5\textwidth]{results/series/real_1_2D_vector}}
\subfloat[]
{\includegraphics[width=0.5\textwidth]{results/series/real_2_2D_vector}}\\
\caption{Проекция точек временного на плоскость при помощи матрицы попарных расстояний $\textbf{M}$: a) для временного ряда Physical Motion 1; b) для временного ряда Physical Motion 2}
\label{fig_real_2D}
\end{figure}

\begin{figure}[h!t]\center
\subfloat[]
{\includegraphics[width=0.5\textwidth]{results/series/real_1_claster_vector}}
\subfloat[]
{\includegraphics[width=0.5\textwidth]{results/series/real_2_claster_vector}}\\
\caption{Кластеризация точек временного ряда: 
a) для временного ряда Physical Motion 1; b) для временного ряда Physical Motion 2}
\label{fig_real_claster}
\end{figure}

\paragraph{Реальные данные.}

На рис. \ref{fig_real_series} приведен пример реальных временных рядов полученных при помощи взятия одной из координат мобильного акселерометра. 

Рис. \ref{fig_real_distance} иллюстрирует матрицы попарных расстояний $\textbf{M}$ между всеми парами точек $t$ временного ряда, которые построены при помощи (\ref{eq:cl:9}). 
Используя матрицу попарных расстояний и метод Multidimensional Scaling \cite{Borg2005} визуализируем точки временного ряда на плоскости. 
На рис. \ref{fig_real_2D} показана визуализация точек на плоскости и выполнена их кластеризация при помощи метода иерархической кластеризации. 
Иллюстрация кластеров точек временного ряда продемонстрирована на рис. \ref{fig_real_claster}.

Сегментация временных рядов проводится на синтетических и реальных данных. Для данного эксперимента в качестве синтетического ряда рассматривается ряд построенный из двух синусов с произвольной частотой и амплитудой. Описание временных рядов, которые используются в данном эксперименте представлены в таблице \ref{table:3}.

Сегментация проводится при помощи метода, который представлен в работе \cite{motrenko2015}. Данный метод применяется для каждого действия внутри временного ряда по отдельности.


\begin{table}[h!t]
\begin{center}
\caption{Описание временных рядов в эксперименте сегментации временных рядов}
\label{table:3}
\begin{tabular}{|c|c|c|c|}
\hline
	Ряд, $\textbf{x}$ &Длина ряда, $N$& Число сегментов, $K$&Длина сегмента, $T$\\
	\hline
	\multicolumn{1}{|l|}{Simple 1}
	& 1000& 2& 100\\
	\hline
	\multicolumn{1}{|l|}{Physical Motion 2}
	& 900& 2& 40\\
\hline

\end{tabular}
\end{center}
\end{table}

\paragraph{Синтетические данные.} На рис. \ref{fig_simple_segmentation} показан результат работы сегментации для временного ряда Simple 1. 
Данный алгоритм хорошо выделил начала сегментов. 
Также на рис. \ref{fig_simple_segmentation} показаны проекции фазовых пространств для обеих кластеров на их первые две главные компоненты.

\begin{figure}[h!t]\center
\subfloat[]
{\includegraphics[width=0.5\textwidth]{results/series/simple_1_segmentation_vector}}
\subfloat[]
{\includegraphics[width=0.25\textwidth]{results/series/simple_1_phase_space0}}
\subfloat[]
{\includegraphics[width=0.25\textwidth]{results/series/simple_1_phase_space1}}\\
\caption{Сегментация точек временного ряда Simple 1: 
a) сегментация временного ряда; b) проекция фазового пространства на первые две главные компоненты для первого кластера; c) проекция фазового пространства на первые две главные компоненты для второго кластера}
\label{fig_simple_segmentation}
\end{figure}

\paragraph{Реальные данные.} На рис. \ref{fig_real_segmentation} показан результат работы сегментации для временного ряда Physical Motion 2. 
Данный алгоритм хорошо выделил начала сегментов для Type 1 и плохо для Type 2. 
Также на рис. \ref{fig_real_segmentation} показаны проекции фазовых пространств для обеих кластеров на их первые две главные компоненты. 
Видно, что в случае проекции фазового пространства для части ряда, который относится к Type 2 получаем, что фазовая траектория имеет самопересечение внутри одного сегмента, что влечет нахождения ложного начала сегмента.

\begin{figure}[h!t]\center
\subfloat[]
{\includegraphics[width=0.5\textwidth]{results/series/real_2_segmentation_vector}}
\subfloat[]
{\includegraphics[width=0.25\textwidth]{results/series/real_2_phase_space0}}
\subfloat[]
{\includegraphics[width=0.25\textwidth]{results/series/real_2_phase_space1}}\\
\caption{Сегментация точек временного ряда Physical Motion 2: 
a) сегментация временного ряда; b) проекция фазового пространства на первые две главные компоненты для первого кластера; c) проекция фазового пространства на первые две главные компоненты для второго кластера}
\label{fig_real_segmentation}
\end{figure}